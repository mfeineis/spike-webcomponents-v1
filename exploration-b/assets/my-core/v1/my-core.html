<script src="my-core.js"></script>
<script>

(function (window) {

    class MyCoreElement extends HTMLElement {
        constructor() {
            super();
        }

        adoptedCallback(...args) {
            console.log(this, 'adoptedCallback', ...args);
        }

        attributeChangedCallback(attr, oldValue, newValue) {
            console.log(this, 'attributeChangedCallback', attr, oldValue, newValue);
        }

        connectedCallback(...args) {
            console.log(this, 'connectedCallback', ...args);
        }

        disconnectedCallback(...args) {
            console.log(this, 'disconnectedCallback', ...args);
        }
    }

    window.customElements.define('my-core', MyCoreElement);

    window.MyCore = {
        define(id, factory) {
            const currentDocument = document.currentScript.ownerDocument;
            const spec = factory(class extends MyCoreElement {
                constructor() {
                    super();

                    const tmpl = currentDocument.querySelector(`template[auto-wire]`);

                    if (tmpl) {
                        const shadow = this.attachShadow({ 
                            mode: "open", 
                        });
                        shadow.appendChild(currentDocument.importNode(tmpl.content, true));

                        //this.appendChild(currentDocument.importNode(tmpl.content, true));
                    }
                }
            });
            window.customElements.define(id, spec);
        }
    };

}(window));

</script>

<script src="my-core.js"></script>
<script>

(function (window) {

    if (window.MyCore) {
        return;
    }

    class MyCoreElement extends HTMLElement {
    }

    window.customElements.define('my-core', MyCoreElement);

    function autoWireTemplate(element, currentDocument) {
        const tmpl = currentDocument.querySelector(`template[auto-wire]`);

        if (tmpl) {
            const shadow = element.attachShadow({ 
                mode: "open", 
            });
            shadow.appendChild(currentDocument.importNode(tmpl.content, true));

            //this.appendChild(currentDocument.importNode(tmpl.content, true));
        }
    }

    function define(id, factory) {
        const currentDocument = document.currentScript.ownerDocument;
        const spec = factory(class extends MyCoreElement {
            constructor() {
                super();
                autoWireTemplate(this, currentDocument);
            }
        });
        window.customElements.define(id, spec);
    }

    window.MyCore = {
        define,
    };

}(window));

</script>
